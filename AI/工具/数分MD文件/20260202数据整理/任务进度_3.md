# 任务进度_3

## 1. 基础信息
- **SQL文件名称**: 任务进度对照表_3
- **数据库**: `nvwa_cbt1`
- **引擎要求**: Spark SQL

## 2. 核心需求
- 按「完成该任务」维度统计：对每个任务 ID，统计**完成过该任务**的玩家数（不要求是该玩家的最后完成任务）
- 统计这些玩家在**完成该任务时**已进行的平均孵化次数（以该次任务完成时间戳为截断点，只计该时刻之前的 PetCreateCustom 条数）
- 输出顺序与任务 ID 顺序参考文件 TaskMainHatch.csv

## 3. 字段信息
- 字段 `lock_region`（或 `ip_region`），参数为 **ID** 或 **BR**
- 日志 `accountregister`，`local_dt` 字段注册日期为 **20260129** 至 **20260130**
- `taskaction` 日志中存在某条 `task_id` 且 `task_action` 字段值为 **2** 时，视为该任务完成；否则视为未完成
- **完成该任务时的孵化次数**：对每个玩家、每个任务，取该玩家该任务在 `taskaction` 中 `task_action=2` 的那条记录的 `local_dt_srv` 作为完成时间戳，统计该玩家在此时刻之前（含当日）的 `PetCreateCustom` 日志条数，即为该玩家在完成该任务时已进行的孵化次数

## 4. 期望输出字段
输出顺序参考文件 **TaskMainHatch.csv**：
- **任务ID**
- **完成该任务的玩家数**（即：在 taskaction 中有该 task_id 且 task_action=2 的去重玩家数）
- **玩家完成该任务时的平均孵化次数**（即：上述玩家在各自完成该任务的时间戳之前已进行的孵化次数的平均值）

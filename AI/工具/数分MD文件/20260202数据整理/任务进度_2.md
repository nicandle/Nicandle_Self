# 任务进度_2

## 1. 基础信息
- **SQL文件名称**: 任务进度对照表_2
- **数据库**: `nvwa_cbt1`
- **引擎要求**: Spark SQL

## 2. 核心需求
- 按「最后完成任务」维度统计：对每个任务 ID，统计**将该任务作为最后完成任务**的玩家数
- 统计这些玩家的平均孵化次数（按首日/次日等分日查看）
- 输出顺序与任务 ID 顺序参考文件 TaskMain.csv

## 3. 字段信息
- 字段 `lock_region`，参数为 **ID** 或 **BR**
- 日志 `accountregister`，`local_dt` 字段注册日期为 **20260129** 至 **20260130**
- `taskaction` 日志中存在某条 `task_id` 且 `task_action` 字段值为 **2** 时，视为该任务完成；否则视为未完成
- **最后完成任务**：该玩家在 `taskaction` 日志中所有 `task_action=2` 的记录里，**时间戳最大**的那条所对应的 `task_id`，即该玩家的「最后完成任务」
- 单个玩家 `petcreatecustom` 日志数量为该玩家的**孵化次数**（分日统计时按对应日期的日志条数）

## 4. 期望输出字段
输出顺序参考文件 **TaskMain.csv**：
- **任务ID**
- **该任务为玩家最后完成任务的玩家数**（即：在所有任务 taskaction 日志中，时间戳最大的那条任务 id 等于当前任务 id 的玩家数）
- **玩家平均孵化次数 PetCreateCustom**（分日查看：如首日平均、次日平均等，按需求拆分）

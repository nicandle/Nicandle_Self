# 派对乱斗：夺宝大作战 - 详细设计文档 (Detailed Design Doc)

**文档状态**: 详细设计 (Detailed Design)  
**核心玩法**: 物理乱斗 (Physics Brawler) + 搬运抢分 (Capture & Score) + 元素博弈 (Elemental Interaction)  
**目标受众**: 开发团队 (程序/策划/美术)

---

## 1. 游戏概述 (Game Overview)

### 1.1 核心循环 (Core Loop)
1.  **抢夺 (Snatch)**: 玩家在物理场景中寻找并抓取随机生成的宝物。
2.  **搬运 (Carry)**: 克服物理重量、地形障碍和其他玩家的干扰，将宝物搬运至得分区。
3.  **博弈 (Combat)**: 利用拳头、头槌或**元素陷阱**攻击对手，迫使其掉落宝物或被击晕。
4.  **得分 (Score)**: 成功提交宝物获得积分，倒计时结束时积分最高者获胜。

### 1.2 胜利条件
- **限时模式**: 3分钟内得分最高的玩家/队伍获胜。
- **突然死亡**: 若平局，进入“金币雨”加时赛，先得分者胜。

---

## 2. 角色与物理机制 (Character & Physics)

### 2.1 物理布娃娃 (Active Ragdoll)
- **软骨骼**: 角色由刚体和关节驱动，具有惯性。
- **重心偏移**: 举起重物时，角色重心前移，移动速度降低 30%-60%（视物品重量而定），转向灵敏度下降。
- **跌倒判定**: 受到冲击力 > 阈值 或 腿部悬空 > 1s 时，角色进入 Ragdoll 状态（失去控制）。

### 2.2 基础操作 (Controls)
- **移动 (WASD)**: 基于力的移动，带有加速度和刹车惯性。
- **跳跃 (Space)**: 蓄力跳跃，举重物时跳跃高度减半。
- **抓取 (Left/Right Mouse)**: 左键控制左手，右键控制右手。
  - **单手抓**: 只能拖拽轻物体，容易松脱。
  - **双手抓**: 可举起重物，连接更稳固。
- **攻击 (Head/Punch)**:
  - **头槌 (Q)**: 瞬时高冲击力，但有 1s 自身硬直。
  - **挥拳 (Click)**: 配合身体扭动产生动量。
- **投掷 (Release + Momentum)**: 松开抓取键的同时甩动鼠标/摇杆，利用惯性将物体抛出。

---

## 3. 元素交互体系 (Elemental System)

### 3.1 三大基础元素
| 元素 | 颜色 | 物理特性 | 状态效果 (Status Effect) |
| :--- | :--- | :--- | :--- |
| **🔥 火 (Fire)** | 红/橙 | **扩散**: 接触可燃物会蔓延。 | **烫手**: 强制松开当前抓取的物体。<br>**恐慌**: 角色不受控地随机奔跑 2s。 |
| **💧 水 (Water)** | 蓝/青 | **流动**: 推动物体位移。 | **打滑**: 地面摩擦力降为 0.1，难以刹车。<br>**潮湿**: 免疫火属性，但导电率 200%。 |
| **⚡ 雷 (Thunder)** | 黄/紫 | **传导**: 通过水或金属传播。 | **麻痹**: 角色完全僵直 (Freeze) 1.5s，随后倒地。<br>**痉挛**: 间歇性触发肌肉抽搐 (随机 AddForce)。 |

### 3.2 元素反应 (Reactions)
- **⚡ + 💧 = 范围触电 (AoE Stun)**: 雷属性攻击/道具打入水域，水域内所有玩家触电。
- **🔥 + 💧 = 蒸汽 (Steam)**: 产生大量白雾遮挡视线，同时消除火状态。
- **🔥 + 💣 (炸弹) = 立即引爆**: 炸弹接触火源无需倒计时直接爆炸。

---

## 4. 物品与得分系统 (Items & Scoring)

### 4.1 宝物类型
| 物品 | 分值 | 重量 | 特性 |
| :--- | :--- | :--- | :--- |
| **金币** | 1 | 轻 | 单手可拿，刷新频率高。 |
| **钻石** | 3 | 重 | 需双手搬运，严重减速。 |
| **皇冠** | 5 | 极重 | 刷新极少，搬运时无法跳跃。 |
| **炸弹** | -2 | 中 | 倒计时爆炸，炸飞周围玩家。可扔进敌方得分区扣分。 |

### 4.2 元素道具
- **火把**: 挥舞可点燃对手。
- **水桶**: 泼水可制造湿滑地面或灭火。
- **电击枪**: 近战接触使对手麻痹。

---

## 5. 关卡设计：元素工厂 (Level: Elemental Factory)

### 5.1 区域规划
- **中央刷新区**: 传送带不断送出宝物和道具。
- **高台得分区**: 位于地图两侧高处，需要跳跃或爬坡才能到达（考验搬运操作）。
- **危险区 (Hazards)**:
  - **底部水池**: 环绕场地的浅水区，常年通电（周期性放电）。
  - **喷火管道**: 随机向场地内喷射火焰。

### 5.2 动态干扰
- **旋转桥**: 连接中央与得分区的桥梁会旋转，有时会断开。
- **风扇**: 巨大的风扇会将轻的物体（金币）吹走，玩家需逆风前行。

---

## 6. UI 与 反馈 (UI & Feedback)

### 6.1 HUD
- **头顶信息**: 玩家 ID + 血条（晕眩条） + **元素状态图标** (燃烧/潮湿/麻痹)。
- **全局信息**: 倒计时 (顶部居中)，实时排行榜 (右侧)。
- **得分反馈**: 物品进入得分区时，屏幕中央弹出 `+3` 浮动文字，并伴随欢呼音效。

### 6.2 视觉特效 (VFX)
- **打击感**: 击中时产生漫画风格的撞击特效 (星星/爆炸)。
- **元素特效**: 
  - 燃烧：角色身上冒火粒子。
  - 麻痹：角色骨骼闪烁黄色电流，呈X光透视状。
  - 潮湿：角色身上滴水粒子。

---

## 7. 技术实现要点 (Technical Notes)

- **网络同步**: 
  - 物品所有权 (Ownership) 在抓取瞬间转移给玩家客户端。
  - 元素状态 (Status) 由服务器统一计算并广播。
- **性能优化**:
  - 限制同屏物理刚体数量 (< 50)。
  - 远距离玩家关闭布娃娃物理模拟，仅使用动画同步。
